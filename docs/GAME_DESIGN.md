# 遊戲設計文件（Game Design Document）

**專案名稱：** Procedural 3D Maze Prototype
**類型：** 第一人稱探索（First-person Exploration）、實驗性原型（Experimental Prototype）
**核心重點：** 演算法學習與實作展示，非商業級遊戲

---

## 一、遊戲願景（Vision）

### 1.1 設計目標

本專案是一個**學習導向的技術原型**，目標是透過實作與視覺化來理解以下演算法：

- **迷宮生成（Procedural Maze Generation）**：隨機生成可探索的 3D 空間
- **路徑搜尋（Pathfinding, A*）**：怪物追蹤玩家的智能移動
- **視線判斷（Line-of-Sight）**：怪物感知系統
- **有限狀態機（Finite State Machine, FSM）**：怪物行為切換邏輯

**不是目標：**
- AAA 級畫面與特效
- 複雜的 UI 系統或劇情敘事
- 完整的遊戲循環與關卡設計

### 1.2 核心體驗（Core Experience）

- **探索感**：每次啟動都是新的隨機迷宮，玩家需要適應新環境
- **緊張感**：怪物會追蹤玩家，但不過度恐怖
- **可愛對比**：類 Backrooms 的詭異空間氛圍 × 可愛風格怪物，形成有趣對比

---

## 二、世界觀與氛圍（World & Atmosphere）

### 2.1 視覺風格（Visual Style）

**Backrooms-like（類後室風格）**

- **空間特徵**：
  - 無限延伸、重複但略有變化的走廊與房間
  - 黃色系牆面、舊式地磚、單調燈光
  - 沒有窗戶、沒有明確出口的封閉感

- **色調**：
  - 主色：米黃、淺灰、髒白
  - 輔助色：昏黃燈光、陰影

- **簡化實作**：
  - 初期使用簡單方塊（Cube）與基礎材質（BasicMaterial / StandardMaterial）
  - 牆面與地板可用單色或簡單貼圖
  - 燈光：環境光（AmbientLight）+ 少量點光源（PointLight）

### 2.2 音效與音樂（Audio）

**後期實作，初期可忽略**

- 環境音：空調低鳴、電燈嗡嗡聲
- 怪物音：輕快的腳步聲、可愛的叫聲
- 玩家音：腳步回音

---

## 三、玩法機制（Gameplay Mechanics）

### 3.1 玩家操作（Player Controls）

**第一人稱視角（First-person View）**

| 操作 | 功能 |
|------|------|
| **WASD** | 前後左右移動 |
| **滑鼠移動** | 視角旋轉（Yaw / Pitch） |
| **Shift（選用）** | 衝刺（加快移動速度） |
| **ESC** | 釋放滑鼠鎖定（Pointer Lock） |

**移動特性**：
- 基於格子系統（Grid-based）但視覺上平滑移動
- 碰撞檢測：不能穿牆
- 重力：簡化處理或直接固定高度（不實作跳躍）

### 3.2 迷宮結構（Maze Structure）

**隨機生成（Procedural Generation）**

- **地圖表示**：使用 2D grid，每個格子代表一個牆（Wall）或地板（Floor）
- **生成演算法**：
  - 初版：DFS-based Maze Generation（深度優先搜尋迷宮生成）
  - 後續可擴充：Room + Corridor、BSP（Binary Space Partitioning）

- **地圖尺寸**：
  - 初期建議：31×31（較小，方便測試）
  - 可透過 `config.js` 調整

- **特殊元素**：
  - 玩家出生點（Spawn Point）
  - 怪物出生點（Monster Spawn）
  - 後期可加入：出口、道具、異常區域

### 3.3 怪物系統（Monster System）

**可愛風格怪物（Cute Monsters）**

- **外型**：
  - 初期：簡單的幾何體（立方體、球體）+ 明亮顏色（粉紅、藍色）
  - 後期可加入：可愛 3D 模型（低多邊形風格）

- **行為狀態（Behavior States）**：

  | 狀態 | 描述 | 觸發條件 |
  |------|------|---------|
  | **Patrol（巡邏）** | 沿預設路線或隨機漫步 | 初始狀態 / 失去玩家後一段時間 |
  | **Chase（追擊）** | 使用 A* 追蹤玩家位置 | 偵測到玩家（視線內） |
  | **Search（搜尋）** | 在最後目擊位置附近徘徊 | 失去視線但記得位置 |
  | **Idle（待機）** | 靜止不動（選用） | 初始或特殊條件 |

- **感知系統（Perception）**：
  - **視距（Vision Range）**：一定半徑內
  - **視角（Field of View）**：前方 120° 錐形範圍
  - **視線遮擋（Occlusion）**：牆壁會阻擋視線（需用 Raycasting 檢查）

- **移動特性**：
  - 速度略低於玩家全速，但高於玩家慢走
  - 平滑移動，不瞬移
  - 轉彎時可加入簡單緩動（Lerp）

**體驗設計考量**：
- 怪物不應過於強勢（讓玩家有躲避空間）
- 追擊時可發出可愛音效，降低恐怖感
- 被抓到可簡單重生，不做懲罰（這是技術展示，不是懲罰玩家）

---

## 四、最小可行版本（Minimum Viable Product, MVP）

### 4.1 MVP 範圍

**Phase 1：基礎場景與移動**
- ✅ 建立專案骨架
- ✅ 顯示簡單 3D 場景（地板 + 牆壁）
- ✅ 第一人稱相機（WASD 移動、滑鼠視角）
- ✅ 使用寫死的 2D grid（hardcoded map）

**Phase 2：隨機迷宮生成**
- ⬜ 實作 DFS 迷宮生成演算法
- ⬜ 可從 `config.js` 調整地圖尺寸
- ⬜ 自動選擇玩家與怪物出生點

**Phase 3：基礎怪物 AI**
- ⬜ 實作 A* 路徑搜尋
- ⬜ 單一怪物：Chase 狀態（看到就追）
- ⬜ 簡單視線判斷（距離檢查）

**Phase 4：完整 FSM 與視線系統**
- ⬜ 實作 Patrol / Chase / Search 狀態切換
- ⬜ 完整視線判斷（視角 + 牆壁遮擋）
- ⬜ 怪物巡邏路線

**Phase 5：體驗優化（選用）**
- ⬜ 音效與音樂
- ⬜ 簡單 UI（生命值、提示）
- ⬜ 多隻怪物
- ⬜ 迷你地圖（Minimap）

### 4.2 成功標準

完成 Phase 1-4 後，應達成：

1. **可玩性**：
   - 每次啟動產生新迷宮
   - 玩家可以流暢移動與探索
   - 怪物能夠有效追蹤與巡邏

2. **演算法展示**：
   - 迷宮生成結果清晰可見
   - 怪物路徑搜尋過程可理解
   - FSM 狀態切換有明確邏輯

3. **程式品質**：
   - 程式碼模組化、可讀性高
   - 演算法有清楚註解
   - 符合單一真相檔原則

---

## 五、後續擴充方向（Future Directions）

以下為完成 MVP 後可考慮的方向，**不急於實作**：

### 5.1 進階迷宮生成

- **多種演算法**：Prim's、Kruskal's、Cellular Automata
- **混合風格**：Room + Corridor、BSP、多樓層結構
- **Biome 系統**：不同區域有不同牆面材質與燈光

### 5.2 進階 AI 行為

- **多怪物協作**：包圍玩家、分工巡邏
- **情緒系統**：怪物有好奇、警戒、憤怒等狀態
- **學習能力**：記住玩家常走路線

### 5.3 遊戲化元素

- **目標系統**：找到出口、收集道具
- **生命值與死亡**：被抓到有懲罰
- **難度遞增**：關卡越深，怪物越多

### 5.4 視覺增強

- **後處理效果**：Bloom、色差、顆粒感
- **動態燈光**：閃爍、陰影
- **粒子效果**：灰塵、霧氣

---

## 六、修訂記錄（Revision History）

| 日期 | 版本 | 修改內容 | 修改者 |
|------|------|---------|--------|
| 2025-11-20 | v0.1 | 初版：定義遊戲願景、MVP 範圍、怪物行為 | Claude Code |

---

**注意：本文件應隨專案進展持續更新，所有遊戲規則與體驗設計變更必須記錄於此。禁止建立 `GAME_DESIGN_v2.md` 等副本。**
